<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Court & Fingerprint Date Calculator</title>
    <style>
        :root {
            --primary-color: #3498db;
            --primary-dark: #2980b9;
            --secondary-color: #f39c12;
            --success-color: #2ecc71;
            --text-color: #2c3e50;
            --light-text: #7f8c8d;
            --background: #ecf0f1;
            --card-bg: #ffffff;
            --border-radius: 12px;
            --box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text-color);
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .container {
            width: 100%;
            max-width: 850px;
            margin: 0 auto;
            background-color: var(--card-bg);
            padding: 40px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--text-color);
            position: relative;
            padding-bottom: 15px;
            font-weight: 600;
        }

        h1::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60%;
            height: 4px;
            background-color: var(--secondary-color);
            border-radius: 2px;
        }

       /* New styles for the notes container */
       .notes-container {
            background-color: rgba(243, 156, 18, 0.1);
            border-left: 4px solid var(--secondary-color);
            padding: 15px 20px;
            margin: 20px 0 30px 0;
            border-radius: 8px;
        }

        .notes-title {
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-color);
        }

        .notes-title:before {
            content: '⚠️';
            font-size: 16px;
        }

        .notes-content {
            color: var(--text-color);
            line-height: 1.5;
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            color: var(--light-text);
            font-size: 14px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
        }

        .form-container {
            background-color: var(--background);
            padding: 30px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-color);
        }

        select, input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: var(--transition);
        }

        select:focus, input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .disabled-field {
            background-color: #f0f0f0;
            cursor: not-allowed;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: var(--transition);
            white-space: nowrap;
            width: 100%;
        }

        button:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .alert {
            padding: 12px 15px;
            background-color: #f8d7da;
            color: #721c24;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            font-weight: 500;
        }

        .results {
            background-color: var(--background);
            padding: 30px;
            border-radius: var(--border-radius);
            display: none;
        }

        h2 {
            margin-bottom: 25px;
            color: var(--text-color);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h2::before {
            content: '';
            display: block;
            width: 15px;
            height: 15px;
            background-color: var(--secondary-color);
            border-radius: 50%;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .result-card {
            background-color: var(--card-bg);
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: var(--transition);
        }

        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }

        .court-card {
            border-left: 4px solid var(--primary-color);
        }

        .fingerprint-card {
            border-left: 4px solid var(--secondary-color);
        }

        .info-title {
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--text-color);
            font-size: 18px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        .info-item {
            margin-bottom: 15px;
        }

        .info-label {
            font-weight: 600;
            color: var(--text-color);
            margin-bottom: 5px;
            display: block;
        }

        .info-value {
            font-size: 16px;
            line-height: 1.4;
            color: var(--text-color);
        }

        .note {
            margin-top: 15px;
            padding: 10px 15px;
            background-color: rgba(243, 156, 18, 0.1);
            border-radius: 6px;
            border-left: 3px solid var(--secondary-color);
        }

        .copy-section {
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-top: 20px;
            border-left: 4px solid var(--secondary-color);
        }

        .copy-section h3 {
            margin-top: 0;
            margin-bottom: 15px;
            color: var(--text-color);
            font-weight: 600;
        }

        .copy-content {
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.03);
            border-radius: 8px;
            margin-bottom: 15px;
            white-space: pre-wrap;
            font-family: monospace;
            color: var(--text-color);
            border: 1px solid #e0e0e0;
        }

        .copy-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 15px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: var(--transition);
            width: auto;
            display: inline-block;
        }

        .copy-btn:hover {
            background-color: #e67e22;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 768px) {
            .container {
                padding: 25px;
            }
            
            .form-container {
                padding: 20px;
            }
            
            .results {
                padding: 20px;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Court & Fingerprint Date Calculator</h1>

        <!-- New Notes Container -->
        <div class="notes-container">
            <div class="notes-title">Important Notes</div>
            <div class="notes-content">
                No current notes.
                <!-- You can customize this text as needed -->
            </div>
        </div>
        
        <div class="alert" id="alert-message"></div>
        
        <div class="form-container">
            <div class="form-group">
                <label for="city">Court City:</label>
                <select id="city">
                    <option value="choose">--Choose City--</option>
                    <option value="vancouver">Vancouver</option>
                    <option value="burnaby">Burnaby</option>
                    <option value="new-westminster">New Westminster</option>
                    <option value="surrey">Surrey (Including Delta, Langley & White Rock)</option>
                    <option value="richmond">Richmond</option>
                    <option value="coquitlam">Coquitlam (Including Port Coquitlam, Port Moody, Pitt Meadows & Maple Ridge)</option>
                    <option value="north-vancouver">North Vancouver (Including West Vancouver)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="case-type">Case Type:</label>
                <select id="case-type">
                    <option value="adult">Adult</option>
                    <option value="youth">Youth</option>
                </select>
            </div>
            
            <div class="form-group" id="initial-group">
                <label for="initial">First Letter of Last Name:</label>
                <input type="text" id="initial" maxlength="1" placeholder="Enter first letter" oninput="this.value = this.value.toUpperCase()">
            </div>
            
            <div class="form-group">
                <label for="weeks">Weeks Out:</label>
                <input type="number" id="weeks" min="1" max="52" value="6">
            </div>
            
            <div class="form-group">
                <label for="squad">Issuing Squad:</label>
                <select id="squad">
                    <option value="A">A Squad</option>
                    <option value="B">B Squad</option>
                    <option value="C">C Squad</option>
                    <option value="D">D Squad</option>
                </select>
            </div>
            
            <button onclick="calculateDates()">Calculate Dates</button>
        </div>
        
        <div class="results" id="results">
            <h2>Results</h2>
            
            <div class="results-grid">
                <div class="result-card court-card">
                    <div class="info-title">Court Information</div>
                    
                    <div class="info-item">
                        <div class="info-label">Date</div>
                        <div class="info-value" id="court-date"></div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-label">Time</div>
                        <div class="info-value" id="court-time"></div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-label">Address</div>
                        <div class="info-value" id="court-address"></div>
                    </div>
                    
                    <div class="note" id="note-section" style="display: none;">
                        <div class="info-value" id="court-note"></div>
                    </div>
                </div>
                
                <div class="result-card fingerprint-card">
                    <div class="info-title">Fingerprint Information</div>
                    
                    <div class="info-item">
                        <div class="info-label">Date</div>
                        <div class="info-value" id="fingerprint-date"></div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-label">Time</div>
                        <div class="info-value" id="fingerprint-time"></div>
                    </div>
                    
                    <div class="info-item">
                        <div class="info-label">Location</div>
                        <div class="info-value" id="fingerprint-location"></div>
                    </div>
                </div>
            </div>
            
            <div class="copy-section">
                <h3>Copy/Paste Format</h3>
                <div id="copy-content" class="copy-content"></div>
                <button class="copy-btn" onclick="copySimpleText()">Copy to Clipboard</button>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            Last Update: 2025-05-02 / GV6272
        </div>

    </div>

    <script>
        // Canadian holidays for 2025 (can be expanded)
        const holidays = [
            new Date(2025, 0, 1),   // New Year's Day
            new Date(2025, 1, 17),  // Family Day (BC)
            new Date(2025, 3, 18),  // Good Friday
            new Date(2025, 3, 21),  // Easter Monday
            new Date(2025, 4, 19),  // Victoria Day
            new Date(2025, 6, 1),   // Canada Day
            new Date(2025, 7, 4),   // BC Day
            new Date(2025, 8, 1),   // Labour Day
            new Date(2025, 8, 30),  // National Day for Truth and Reconciliation
            new Date(2025, 9, 13),  // Thanksgiving
            new Date(2025, 10, 11), // Remembrance Day
            new Date(2025, 11, 25), // Christmas Day
            new Date(2025, 11, 26)  // Boxing Day
        ];
        
        // RICHMOND COURT DATES 2025
        // This is a complete list of all Richmond court dates in 2025 with their correct rotation
        const richmondCourtDates = {
            "A-K": [
                new Date(2025, 0, 7),  // January 7
                new Date(2025, 0, 21), // January 21
                new Date(2025, 1, 4),  // February 4
                new Date(2025, 1, 18), // February 18
                new Date(2025, 2, 4),  // March 4
                new Date(2025, 2, 18), // March 18
                new Date(2025, 3, 1),  // April 1
                new Date(2025, 3, 15), // April 15
                new Date(2025, 3, 29), // April 29
                new Date(2025, 4, 13), // May 13
                new Date(2025, 4, 27), // May 27
                new Date(2025, 5, 10), // June 10
                new Date(2025, 5, 24), // June 24
                new Date(2025, 6, 15), // July 15
                new Date(2025, 6, 29), // July 29
                new Date(2025, 7, 12), // August 12
                new Date(2025, 7, 26), // August 26
                new Date(2025, 8, 9),  // September 9
                new Date(2025, 8, 23), // September 23
                new Date(2025, 9, 14), // October 14 - Note: Oct 7 is L-Z after Sept 30 holiday
                new Date(2025, 9, 28), // October 28
                new Date(2025, 10, 18), // November 18 - Note: After Nov 11 Remembrance Day holiday
                new Date(2025, 11, 2),  // December 2
                new Date(2025, 11, 16), // December 16
                new Date(2025, 11, 30)  // December 30
            ],
            "L-Z": [
                new Date(2025, 0, 14), // January 14
                new Date(2025, 0, 28), // January 28
                new Date(2025, 1, 11), // February 11
                new Date(2025, 1, 25), // February 25
                new Date(2025, 2, 11), // March 11
                new Date(2025, 2, 25), // March 25
                new Date(2025, 3, 8),  // April 8
                new Date(2025, 3, 22), // April 22
                new Date(2025, 4, 6),  // May 6
                new Date(2025, 4, 20), // May 20
                new Date(2025, 5, 3),  // June 3
                new Date(2025, 5, 17), // June 17
                new Date(2025, 6, 8),  // July 8  - Note: July 1 is Canada Day (holiday)
                new Date(2025, 6, 22), // July 22
                new Date(2025, 7, 5),  // August 5 - Note: August 4 is BC Day (holiday)
                new Date(2025, 7, 19), // August 19
                new Date(2025, 8, 2),  // September 2 - Note: September 1 is Labour Day (holiday)
                new Date(2025, 8, 16), // September 16
                new Date(2025, 9, 7),  // October 7 - Note: Sept 30 is Truth & Reconciliation Day (holiday)
                new Date(2025, 9, 21), // October 21
                new Date(2025, 10, 4), // November 4
                new Date(2025, 10, 25), // November 25
                new Date(2025, 11, 9),  // December 9
                new Date(2025, 11, 23)  // December 23
            ]
        };

        // Function to handle the initial field toggle
        function toggleInitialField() {
            const caseType = document.getElementById('case-type').value;
            const city = document.getElementById('city').value;
            const initialField = document.getElementById('initial');
            const caseTypeSelect = document.getElementById('case-type');
            const caseTypeLabel = document.querySelector('label[for="case-type"]');
            
            // For Richmond, don't disable the initial field for youth
            if (city === 'richmond') {
                // Richmond needs last name for rotating schedule regardless of case type
                initialField.disabled = false;
                initialField.classList.remove('disabled-field');
                initialField.placeholder = "Enter first letter";
                
                // Add a note to the case type label if youth is selected
                if (caseType === 'youth') {
                    caseTypeLabel.innerHTML = 'Case Type: <small style="font-weight:normal;color:#666;">(Richmond youth follow the same schedule as adults)</small>';
                } else {
                    caseTypeLabel.innerHTML = 'Case Type:';
                }
            } else if (caseType === 'youth' || city === 'new-westminster' || city === 'coquitlam' || city === 'north-vancouver') {
                initialField.disabled = true;
                initialField.classList.add('disabled-field');
                let placeholder = "Not required";
                if (caseType === 'youth' && city !== 'coquitlam' && city !== 'north-vancouver') {
                    placeholder = "Not required for Youth";
                } else if (city === 'new-westminster') {
                    placeholder = "Not required for New Westminster";
                } else if (city === 'coquitlam') {
                    placeholder = "Not required for Coquitlam";
                } else if (city === 'north-vancouver') {
                    placeholder = "Not required for North Vancouver";
                }
                initialField.placeholder = placeholder;
                initialField.value = "";
                caseTypeLabel.innerHTML = 'Case Type:';
            } else if (caseType === 'youth' && city === 'surrey') {
                initialField.disabled = true;
                initialField.classList.add('disabled-field');
                initialField.placeholder = "Not required for Youth";
                initialField.value = "";
                caseTypeLabel.innerHTML = 'Case Type:';
            } else {
                initialField.disabled = false;
                initialField.classList.remove('disabled-field');
                initialField.placeholder = "Enter first letter";
                caseTypeLabel.innerHTML = 'Case Type:';
            }
        }

        // Add event listener to case type and city dropdowns
        document.getElementById('case-type').addEventListener('change', toggleInitialField);
        document.getElementById('city').addEventListener('change', toggleInitialField);
        
        // Initialize on page load
        window.addEventListener('load', toggleInitialField);

        function isHoliday(date) {
            return holidays.some(holiday => 
                holiday.getDate() === date.getDate() &&
                holiday.getMonth() === date.getMonth() &&
                holiday.getFullYear() === date.getFullYear()
            );
        }

        function isWeekend(date) {
            const day = date.getDay();
            return day === 0 || day === 6; // 0 is Sunday, 6 is Saturday
        }

        function formatDate(date) {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString('en-CA', options);
        }

        function showAlert(message) {
            const alert = document.getElementById('alert-message');
            alert.textContent = message;
            alert.style.display = 'block';
            
            // Hide after 5 seconds
            setTimeout(() => {
                alert.style.display = 'none';
            }, 5000);
        }
        
        function copySimpleText() {
            const content = document.getElementById('copy-content').innerText;
            
            // Create a temporary element for copying
            const tempElement = document.createElement('textarea');
            tempElement.value = content;
            document.body.appendChild(tempElement);
            tempElement.select();
            document.execCommand('copy');
            document.body.removeChild(tempElement);
            
            // Show feedback
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = "Copied!";
            setTimeout(() => {
                button.textContent = originalText;
            }, 2000);
        }
        
        // Helper function to find closest date
        function findClosestDate(targetWeeksOut, dateList) {
            const today = new Date();
            const targetDate = new Date(today);
            targetDate.setDate(today.getDate() + (targetWeeksOut * 7));
            
            let closestDate = null;
            let minDiff = Number.MAX_VALUE;
            
            for (const date of dateList) {
                const diff = Math.abs(date - targetDate);
                if (diff < minDiff) {
                    minDiff = diff;
                    closestDate = date;
                }
            }
            
            return closestDate;
        }

        function calculateDates() {
            // Get input values
            const city = document.getElementById('city').value;
            const initial = document.getElementById('initial').value.toUpperCase();
            const weeksOut = parseInt(document.getElementById('weeks').value);
            const squad = document.getElementById('squad').value;
            const caseType = document.getElementById('case-type').value;
            
            // Validate inputs
            if (caseType === 'adult' && 
                (city !== 'new-westminster') && 
                city !== 'richmond' && 
                city !== 'coquitlam' && 
                city !== 'north-vancouver' && 
                !initial) {
                showAlert('Please enter the first letter of the last name.');
                return;
            }
            
            if (city === 'richmond' && !initial) {
                showAlert('Please enter the first letter of the last name.');
                return;
            }
            
            if (isNaN(weeksOut) || weeksOut < 1 || weeksOut > 52) {
                showAlert('Please enter a valid number of weeks (1-52).');
                return;
            }
            
            let targetDate;
            
            // SPECIAL HANDLING FOR RICHMOND
            if (city === 'richmond') {
                // For Richmond, find the closest date that matches the last name group
                const nameGroup = /^[A-K]$/i.test(initial) ? "A-K" : "L-Z";
                targetDate = findClosestDate(weeksOut, richmondCourtDates[nameGroup]);
            } 
            // REGULAR HANDLING FOR OTHER CITIES
            else {
                // Determine court day based on city, initial and case type
                let courtWeekday;
                let youthCase = (caseType === 'youth');
                
                if (city === 'new-westminster') {
                    // New Westminster is always Wednesday, regardless of last name
                    courtWeekday = 3; // Wednesday
                } else if (city === 'surrey' && youthCase) {
                    // Surrey youth cases are always on Wednesday
                    courtWeekday = 3; // Wednesday
                } else if (city === 'surrey') {
                    // Surrey adult cases follow this schedule
                    if (/^[A-C]$/.test(initial)) {
                        courtWeekday = 1; // Monday
                    } else if (/^[D-H]$/.test(initial)) {
                        courtWeekday = 2; // Tuesday
                    } else if (/^[I-L]$/.test(initial)) {
                        courtWeekday = 3; // Wednesday
                    } else if (/^[M-R]$/.test(initial)) {
                        courtWeekday = 4; // Thursday
                    } else if (/^[S-Z]$/.test(initial)) {
                        courtWeekday = 5; // Friday
                    } else {
                        showAlert('Please enter a valid letter (A-Z).');
                        return;
                    }
                } else if ((city === 'vancouver' || city === 'burnaby') && youthCase) {
                    // Youth cases for Vancouver or Burnaby are always on Thursday
                    courtWeekday = 4; // Thursday
                } else if (city === 'vancouver' || city === 'burnaby') {
                    // Adult cases follow the letter schedule
                    if (/^[A-F]$/.test(initial)) {
                        courtWeekday = 1; // Monday
                    } else if (/^[G-L]$/.test(initial)) {
                        courtWeekday = 2; // Tuesday
                    } else if (/^[M-R]$/.test(initial)) {
                        courtWeekday = 3; // Wednesday
                    } else if (/^[S-Z]$/.test(initial)) {
                        courtWeekday = 4; // Thursday
                    } else {
                        showAlert('Please enter a valid letter (A-Z).');
                        return;
                    }
                } else if (city === 'coquitlam') {
                    // Use the weeks input to determine a weekday (Monday-Friday)
                    const weekdayIndex = weeksOut % 5; // 0-4
                    // Convert to Monday-Friday (1-5)
                    courtWeekday = weekdayIndex + 1;
                    // If it equals 0, make it 5 (Friday)
                    if (weekdayIndex === 0) courtWeekday = 5;
                } else if (city === 'north-vancouver') {
                    // North Vancouver - different days for adult and youth
                    if (caseType === 'youth') {
                        courtWeekday = 1; // Monday for youth
                    } else {
                        courtWeekday = 3; // Wednesday for adult
                    }
                }
                
                // Calculate the court date
                const today = new Date();
                targetDate = new Date(today);
                
                // Add weeks but adjust for the appropriate weekday
                targetDate.setDate(today.getDate() + (weeksOut * 7));
                
                // Then find the closest occurrence of the desired weekday
                const dayDiff = courtWeekday - targetDate.getDay();
                
                // Adjust to closest occurrence
                if (dayDiff > 3) {
                    targetDate.setDate(targetDate.getDate() + (dayDiff - 7));
                } else if (dayDiff < -3) {
                    targetDate.setDate(targetDate.getDate() + (dayDiff + 7));
                } else {
                    targetDate.setDate(targetDate.getDate() + dayDiff);
                }
                
                // Check if the court date lands on a holiday
                if (isHoliday(targetDate)) {
                    // Move to next valid court day
                    targetDate.setDate(targetDate.getDate() + 7);
                    while (isHoliday(targetDate)) {
                        targetDate.setDate(targetDate.getDate() + 7);
                    }
                }
            }
            
            // Ensure targetDate is a valid date before proceeding
            if (!targetDate || isNaN(targetDate.getTime())) {
                showAlert('Error: Invalid date calculated. Please try different parameters.');
                return;
            }
            
            // Calculate fingerprint date
            let fingerprintDate = new Date(targetDate);
            fingerprintDate.setDate(targetDate.getDate() - 2);
            
            // Handle special case for Monday court dates - use previous Thursday (4 days prior)
            if (targetDate.getDay() === 1) { // If court date is Monday
                fingerprintDate = new Date(targetDate);
                fingerprintDate.setDate(targetDate.getDate() - 4); // Go to Thursday
            } else if (targetDate.getDay() === 5) { // If court date is Friday (for Surrey)
                fingerprintDate = new Date(targetDate);
                fingerprintDate.setDate(targetDate.getDate() - 2); // Go to Wednesday
            } else {
                // For other court days, ensure fingerprint is on Tue, Wed, or Thu
                const fpDay = fingerprintDate.getDay();
                if (fpDay === 0) { // Sunday
                    fingerprintDate.setDate(fingerprintDate.getDate() - 3); // Go to Thursday
                } else if (fpDay === 6) { // Saturday
                    fingerprintDate.setDate(fingerprintDate.getDate() - 2); // Go to Thursday
                } else if (fpDay === 1) { // Monday
                    fingerprintDate.setDate(fingerprintDate.getDate() - 4); // Go to Thursday
                } else if (fpDay === 5) { // Friday
                    fingerprintDate.setDate(fingerprintDate.getDate() - 1); // Go to Thursday
                }
            }
            
            // Check if fingerprint date is a holiday
            if (isHoliday(fingerprintDate)) {
                // Try previous day
                fingerprintDate.setDate(fingerprintDate.getDate() - 1);
                if (isHoliday(fingerprintDate) || fingerprintDate.getDay() === 1) { // If still holiday or Monday
                    fingerprintDate.setDate(fingerprintDate.getDate() - 1);
                    if (isHoliday(fingerprintDate) || fingerprintDate.getDay() === 0) { // If still holiday or Sunday
                        fingerprintDate.setDate(fingerprintDate.getDate() - 2); // Go to previous Thursday
                    }
                }
            }
            
            // Display results
            document.getElementById('court-date').textContent = formatDate(targetDate);
            
            // Set court time and address based on city and case type
            let courtTime = '';
            let courtAddress = '';
            let courtNote = '';
            
            if (city === 'richmond') {
                courtTime = '0900hrs';
                courtAddress = 'Richmond Provincial Court: 7577 Elmbridge Way, Richmond, BC V6X 4J2';
                
                // Determine if this is a A-K or L-Z date
                const isAKDate = richmondCourtDates["A-K"].some(date => 
                    date.getDate() === targetDate.getDate() &&
                    date.getMonth() === targetDate.getMonth() &&
                    date.getFullYear() === targetDate.getFullYear()
                );
                
                const rotation = isAKDate ? "A-K" : "L-Z";
                courtNote = `This date is for last names ${rotation}.`;
                
                // Add note for youth
                if (caseType === 'youth') {
                    courtNote += ' Youth attend the same court.';
                }
            } else if (city === 'surrey') {
                if (caseType === 'youth') {
                    // Surrey youth court
                    courtTime = '0930hrs';
                    courtAddress = 'Surrey Provincial Court: Courtroom 312 - 14340 57th Ave, Surrey, BC V3X 1B2';
                    courtNote = 'This court covers Surrey, Delta, Langley & White Rock.';
                } else {
                    // Surrey adult court (9:00 AM)
                    courtTime = '0900hrs';
                    courtAddress = 'Surrey Provincial Court: Courtroom 100 - 14340 57th Ave, Surrey, BC V3X 1B2';
                    courtNote = 'This court covers Surrey, Delta, Langley & White Rock.';
                }
            } else if (city === 'new-westminster') {
                // New Westminster
                courtTime = '0900hrs';
                courtAddress = 'New Westminster Law Courts: 651 Carnarvon Street, New Westminster, BC V3M 1C9';
                courtNote = 'Client needs to check docket for court room number.';
            } else if (caseType === 'youth' && (city === 'vancouver' || city === 'burnaby')) {
                // Youth court details
                courtTime = '0930hrs';
                courtAddress = 'Vancouver Provincial Court: Courtroom 101 - 800 Hornby Street, Vancouver, BC V6Z 2C5';
                courtNote = 'This court covers Vancouver and Burnaby.';
            } else if (city === 'vancouver') {
                // Vancouver adult
                courtTime = '1400hrs';
                courtAddress = 'Vancouver Provincial Court: Courtroom 307 - 222 Main Street, Vancouver, BC V6A 2S8';
                courtNote = 'This court covers Vancouver and Burnaby.';
            } else if (city === 'burnaby') {
                // Burnaby adult
                courtTime = '1330hrs';
                courtAddress = 'Vancouver Provincial Court: Courtroom 307 - 222 Main Street, Vancouver, BC V6A 2S8';
                courtNote = 'This court covers Vancouver and Burnaby.';
            } else if (city === 'coquitlam') {
                // Coquitlam area (including Port Coquitlam) - both adult and youth
                courtTime = '1400hrs';
                courtAddress = 'Port Coquitlam Provincial Court: 2620 Mary Hill Rd, Port Coquitlam, BC V3C 3B2';
                courtNote = 'This court covers Coquitlam, Port Coquitlam, Port Moody, Pitt Meadows & Maple Ridge.';
            } else if (city === 'north-vancouver') {
                // North Vancouver - different times for adult and youth
                if (caseType === 'youth') {
                    courtTime = '0930hrs';
                } else {
                    courtTime = '0900hrs';
                }
                courtAddress = 'North Vancouver Provincial Court: Courtroom 2 - 200 East 23rd Ave, North Vancouver, BC V7L 4R4';
                courtNote = 'This court covers North Vancouver and West Vancouver.';
            }
            
            document.getElementById('court-time').textContent = courtTime;
            document.getElementById('court-address').textContent = courtAddress;
            
            // Add note if applicable
            const noteElement = document.getElementById('court-note');
            const noteSection = document.getElementById('note-section');
            if (noteElement && noteSection) {
                if (courtNote) {
                    noteElement.textContent = courtNote;
                    noteSection.style.display = 'block';
                } else {
                    noteSection.style.display = 'none';
                }
            }
            
            document.getElementById('fingerprint-date').textContent = formatDate(fingerprintDate);
            
            // Set fingerprint time based on squad
            let fingerprintTime = '';
            if (squad === 'A' || squad === 'C') {
                fingerprintTime = '0900hrs';
            } else if (squad === 'B' || squad === 'D') {
                fingerprintTime = '1800hrs';
            }
            document.getElementById('fingerprint-time').textContent = fingerprintTime;
            document.getElementById('fingerprint-location').textContent = 'MVTP HQ: 300-287 Nelson\'s Court, New Westminster, BC V3L 0E7';
            
            // Determine court details for copy text
            let courtTimeForCopy, courtLocationForCopy, courtNoteForCopy = '';
            
            if (city === 'richmond') {
                courtTimeForCopy = '0900hrs';
                courtLocationForCopy = 'Richmond Provincial Court: 7577 Elmbridge Way, Richmond, BC V6X 4J3';
                
                // Determine if this is a A-K or L-Z date
                const isAKDate = richmondCourtDates["A-K"].some(date => 
                    date.getDate() === targetDate.getDate() &&
                    date.getMonth() === targetDate.getMonth() &&
                    date.getFullYear() === targetDate.getFullYear()
                );
                
                const rotation = isAKDate ? "A-K" : "L-Z";
                courtNoteForCopy = ` (This date is for last names ${rotation})`;
            } else if (city === 'surrey') {
                if (caseType === 'youth') {
                    courtTimeForCopy = '0930hrs';
                    courtLocationForCopy = 'Surrey Provincial Court: Courtroom 312 - 14340 57th Ave, Surrey, BC V3X 1B2';
                } else {
                    courtTimeForCopy = '0900hrs';
                    courtLocationForCopy = 'Surrey Provincial Court: Courtroom 100 - 14340 57th Ave, Surrey, BC V3X 1B2';
                }
            } else if (city === 'new-westminster') {
                courtTimeForCopy = '0900hrs';
                courtLocationForCopy = 'New Westminster Law Courts: 651 Carnarvon Street, New Westminster, BC V3M 1C9';
                courtNoteForCopy = ' (Check docket for court room number)';
            } else if (caseType === 'youth' && (city === 'vancouver' || city === 'burnaby')) {
                courtTimeForCopy = '0930hrs';
                courtLocationForCopy = 'Vancouver Provincial Court: Courtroom 101 - 800 Hornby Street, Vancouver, BC V6Z 2C5';
            } else if (city === 'vancouver') {
                courtTimeForCopy = '1400hrs';
                courtLocationForCopy = 'Vancouver Provincial Court: Courtroom 307 - 222 Main Street, Vancouver, BC V6A 2S8';
            } else if (city === 'burnaby') {
                courtTimeForCopy = '1330hrs';
                courtLocationForCopy = 'Vancouver Provincial Court: Courtroom 307 - 222 Main Street, Vancouver, BC V6A 2S8';
            } else if (city === 'coquitlam') {
                courtTimeForCopy = '1400hrs';
                courtLocationForCopy = 'Port Coquitlam Provincial Court: 2620 Mary Hill Rd, Port Coquitlam, BC V3C 3B2';
            } else if (city === 'north-vancouver') {
                if (caseType === 'youth') {
                    courtTimeForCopy = '0930hrs';
                    courtLocationForCopy = 'North Vancouver Provincial Court: Courtroom 2 - 200 East 23rd Ave, North Vancouver, BC V7L 4R4';
                    courtNoteForCopy = ' (Youth court)';
                } else {
                    courtTimeForCopy = '0900hrs';
                    courtLocationForCopy = 'North Vancouver Provincial Court: Courtroom 2 - 200 East 23rd Ave, North Vancouver, BC V7L 4R4';
                }
            }
            
            // Create the simple text for copy/paste
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            
            const courtDay = days[targetDate.getDay()];
            const courtMonth = months[targetDate.getMonth()];
            const courtDayNum = targetDate.getDate();
            const courtYear = targetDate.getFullYear();
            
            const fpDay = days[fingerprintDate.getDay()];
            const fpMonth = months[fingerprintDate.getMonth()];
            const fpDayNum = fingerprintDate.getDate();
            const fpYear = fingerprintDate.getFullYear();
            
            const fpTimeShort = (squad === 'A' || squad === 'C') ? '0900hrs' : '1800hrs';
            
            const copyText = `Court date: ${courtDay} ${courtMonth} ${courtDayNum} ${courtYear} at ${courtTimeForCopy} - ${courtLocationForCopy} // Fingerprint date: ${fpDay} ${fpMonth} ${fpDayNum} ${fpYear} at ${fpTimeShort} - MVTP HQ: 300-287 Nelson's Court, New Westminster, BC V3L 0E7`;
            
            document.getElementById('copy-content').innerText = copyText;
            
            // Show results section
            document.getElementById('results').style.display = 'block';
        }
    </script>
</body>
</html>